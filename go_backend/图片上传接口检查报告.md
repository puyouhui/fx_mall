# 图片上传接口检查报告

## 后端接口检查

### 1. 商品图片上传
- **接口**: `POST /admin/products/upload`
- **处理函数**: `UploadProductImage`
- **上传目录**: `products` ✅
- **代码位置**: `go_backend/internal/api/handlers.go:679-701`

### 2. 图库图片上传（支持分类）
- **接口**: `POST /admin/images/upload`
- **处理函数**: `UploadImageWithCategory`
- **上传目录**: 支持指定分类，默认 `others` ✅
- **支持分类**: products, carousels, categories, users, delivery, others, rich-content
- **代码位置**: `go_backend/internal/api/handlers.go:703-754`

### 3. 轮播图上传
- **接口**: `POST /admin/carousels/upload`
- **处理函数**: `UploadCarouselImage`
- **上传目录**: `carousels` ✅
- **代码位置**: `go_backend/internal/api/handlers.go:1178-1200`

### 4. 分类图标上传
- **接口**: `POST /admin/categories/upload`
- **处理函数**: `UploadCategoryImage`
- **上传目录**: `categories` ✅
- **代码位置**: `go_backend/internal/api/handlers.go:1224-1246`

### 5. 配送相关图片上传
- **接口**: `POST /employee/delivery/orders/:id/complete`
- **处理函数**: `CompleteDeliveryOrder`
- **上传目录**: `delivery` ✅
- **上传字段**: `product_image` (货物照片), `doorplate_image` (门牌照片)
- **代码位置**: `go_backend/internal/api/employee_delivery.go:737-799`

### 6. 销售员上传地址头像
- **接口**: `POST /employee/upload/address-avatar`
- **处理函数**: `UploadAddressAvatarByEmployee`
- **上传目录**: `users` ✅
- **代码位置**: `go_backend/internal/api/employee_sales.go:1660-1685`

### 7. 小程序用户头像上传
- **接口**: `POST /mini-app/user/avatar`
- **处理函数**: `UploadUserAvatar`
- **上传目录**: `users` ✅
- **代码位置**: `go_backend/internal/api/mini_app_auth.go:1155-1161`

### 8. 小程序用户头像上传（更新接口）
- **接口**: `PUT /mini-app/user/avatar`
- **处理函数**: `UpdateUserAvatar`
- **上传目录**: `users` ✅
- **代码位置**: `go_backend/internal/api/mini_app_auth.go:1245-1246`

### 9. 小程序地址头像上传
- **接口**: `POST /mini-app/addresses/avatar`
- **处理函数**: `UploadAddressAvatar`
- **上传目录**: `users` ✅
- **代码位置**: `go_backend/internal/api/mini_app_auth.go:1310-1311`

### 10. 管理员上传地址头像
- **接口**: `POST /admin/addresses/avatar`
- **处理函数**: `UploadAddressAvatarByAdmin`
- **上传目录**: `users` ✅
- **代码位置**: `go_backend/internal/api/mini_app_auth.go:1364-1365`

## 前端调用检查

### 1. 商品图片上传
- **API文件**: `admin_console/src/api/product.js`
- **函数**: `uploadProductImage`
- **调用位置**: `admin_console/src/views/Products.vue:1224`
- **状态**: ✅ 正确调用 `/admin/products/upload`

### 2. 图库图片上传
- **API文件**: `admin_console/src/api/imageLibrary.js`
- **函数**: `uploadImage(formData, category = 'others')`
- **调用位置**: `admin_console/src/views/ImageLibrary.vue:502`
- **状态**: ✅ 正确传递 category 参数

### 3. 轮播图上传
- **API文件**: `admin_console/src/api/carousel.js`
- **函数**: `uploadCarouselImage`
- **调用位置**: `admin_console/src/views/Carousel.vue:376`
- **状态**: ✅ 正确调用 `/admin/carousels/upload`

### 4. 分类图标上传
- **API文件**: `admin_console/src/api/category.js`
- **函数**: `uploadCategoryImage`
- **调用位置**: `admin_console/src/views/Categories.vue:359`
- **状态**: ✅ 正确调用 `/admin/categories/upload`

### 5. 富文本图片上传
- **API文件**: `admin_console/src/api/richContent.js`
- **函数**: `uploadImage`
- **调用位置**: `admin_console/src/views/RichContent.vue:506`
- **状态**: ✅ 正确传递 `category: 'rich-content'`

## 总结

所有图片上传接口都已正确配置，上传到对应的目录：
- ✅ 商品图片 → `products`
- ✅ 轮播图 → `carousels`
- ✅ 分类图标 → `categories`
- ✅ 用户相关（头像、地址头像）→ `users`
- ✅ 配送相关 → `delivery`
- ✅ 图库管理 → 支持指定分类，默认 `others`
- ✅ 富文本图片 → `rich-content`

所有接口都通过 `utils.UploadFile` 或 `utils.UploadFileByFieldName` 函数上传，这些函数会根据传入的 category 参数将文件上传到对应的目录。

